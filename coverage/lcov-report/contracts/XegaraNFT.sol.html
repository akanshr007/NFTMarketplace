<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/XegaraNFT.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> XegaraNFT.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">89.33% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>67/75</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">58.06% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>36/62</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">81.25% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>13/16</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">90.67% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>68/75</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">18×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">107×</span>
<span class="cline-any cline-yes">106×</span>
<span class="cline-any cline-yes">105×</span>
<span class="cline-any cline-yes">104×</span>
<span class="cline-any cline-yes">104×</span>
<span class="cline-any cline-yes">104×</span>
<span class="cline-any cline-yes">104×</span>
<span class="cline-any cline-yes">104×</span>
<span class="cline-any cline-yes">104×</span>
<span class="cline-any cline-yes">104×</span>
<span class="cline-any cline-yes">104×</span>
<span class="cline-any cline-yes">104×</span>
<span class="cline-any cline-yes">104×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">14×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">14×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">14×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">14×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
pragma solidity &gt;=0.8.17;
&nbsp;
import "@openzeppelin/contracts-upgradeable/token/ERC1155/extensions/ERC1155URIStorageUpgradeable.sol";
import "@openzeppelin/contracts-upgradeable/token/ERC1155/extensions/ERC1155BurnableUpgradeable.sol";
import "@openzeppelin/contracts-upgradeable/access/OwnableUpgradeable.sol";
import "@openzeppelin/contracts-upgradeable/interfaces/IERC20Upgradeable.sol";
import "@openzeppelin/contracts-upgradeable/utils/cryptography/EIP712Upgradeable.sol";
import "@openzeppelin/contracts-upgradeable/security/ReentrancyGuardUpgradeable.sol";
// import "@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol";
import "./interface/IFactory.sol";
import "./interface/IDividend.sol";
import "./Library/structs.sol";
&nbsp;
/**
 * @title XegaraNFT
 * @dev Contract for managing ERC1155 fractional NFTs with buy functionality.
 * @notice This contract allows users to create, buy, and transfer ERC1155 fractional NFTs.
 */
contract XegaraNFT is
    ERC1155URIStorageUpgradeable,
    OwnableUpgradeable,
    EIP712Upgradeable,
    ReentrancyGuardUpgradeable
{
    address public admin;
    address private conversionRateOperator;
    uint256 public platformFee;
    IFactory public factory;
    mapping(uint256 =&gt; uint256) supply;
    mapping(uint256 =&gt; address[]) NFTHolders;
    // Mapping for used Listing vouchers
    mapping(uint256 =&gt; bool) public usedListingCounters;
    mapping(uint256 =&gt; bool) public usedBuyDataCounters;
    // Mapping of the counter to the amount left in voucher
    mapping(uint256 =&gt; uint256) public amountLeft;
&nbsp;
    modifier onlyAdmin() {
        require(msg.sender == admin, "Not Admin");
        _;
    }
&nbsp;
    // constructor() {
    //     _disableInitializers();
    // }
&nbsp;
    /**
     * @dev Initializes the contract.
     * @param _uri The base URI for the token metadata.
     * @param _factory The address of the factory contract.
     * @param _platformfee is the fee percentage for platform.
     * @param _conversionRateOperator The address of the conversion rate operator contract.
     */
    function initialize(
        string memory _uri,
        address _admin,
        address _factory,
        uint256 _platformfee,
        address _conversionRateOperator
    ) external initializer {
        require(_admin!=address(0),"AZA"); // Admin address cannot be zero
        require(_factory != address(0), "FZA"); //Factory address cannot be zero
        require(_conversionRateOperator != address(0), "CZA"); // Conversion Rate Operator address cannot be zero
        <span class="missing-if-branch" title="else path not taken" >E</span>require(_platformfee &gt; 0, "ZF"); // Zero Fee
        __ERC1155_init_unchained(_uri);
        __ERC1155URIStorage_init_unchained();
        __EIP712_init_unchained("XEGARA_NFT", "1");
        __Ownable_init_unchained();
        __ReentrancyGuard_init_unchained();
        conversionRateOperator = _conversionRateOperator;
        factory = IFactory(_factory);
        platformFee = _platformfee;
        admin = _admin;
    }
&nbsp;
    /**
     * @dev Verifies the signed data for NFT details.
     * @param _nftData The NFT details data structure.
     * @return The address of the signer.
     */
    function verifyNFTDetails(
        structs.NFTDetails memory _nftData
    ) public view returns (address) {
        bytes32 signed_data = _hashTypedDataV4(
            keccak256(
                abi.encode(
                    keccak256(
                        "NFTDetails(uint256 tokenId,uint256 fractionsQuantity,string uri,address owner)"
                    ),
                    _nftData.tokenId,
                    _nftData.fractionsQuantity,
                    keccak256(bytes(_nftData.uri)),
                    _nftData.owner
                )
            )
        );
&nbsp;
        return ECDSAUpgradeable.recover(signed_data, _nftData.signature);
    }
&nbsp;
    /**
     * @dev Verifies the signed data for Buy details.
     * @param _buyData The buy details data structure.
     * @return The address of the signer.
     */
    function verifyBuyDetails(
        structs.buyDetails memory _buyData
    ) public view returns (address) {
        bytes32 signed_data = _hashTypedDataV4(
            keccak256(
                abi.encode(
                    keccak256(
                        "buyDetails(uint256 conversionRate,uint256 amountToBuy,uint256 counter,uint256 timeStamp,address currency)"
                    ),
                    _buyData.conversionRate,
                    _buyData.amountToBuy,
                    _buyData.counter,
                    _buyData.timeStamp,
                    _buyData.currency
                )
            )
        );
&nbsp;
        return ECDSAUpgradeable.recover(signed_data, _buyData.signature);
    }
&nbsp;
    /**
     * @dev Verifies the signed data for NFT listing.
     * @param _nftListing The NFT listing data structure.
     * @return The address of the signer.
     */
    function verifyNFTListing(
        structs.NFTListing memory _nftListing
    ) public view returns (address) {
        bytes32 signed_data = _hashTypedDataV4(
            keccak256(
                abi.encode(
                    keccak256(
                        "NFTListing(uint256 pricePerShare,uint256 tokenId,uint256 counter,uint256 nftAmount,address owner)"
                    ),
                    _nftListing.pricePerShare,
                    _nftListing.tokenId,
                    _nftListing.counter,
                    _nftListing.nftAmount,
                    _nftListing.owner
                )
            )
        );
&nbsp;
        return ECDSAUpgradeable.recover(signed_data, _nftListing.signature);
    }
&nbsp;
    /**
     * @dev Creates a new ERC1155 token.
     * @param _nftData The NFT details data structure.
     * @notice This function allows the contract owner to create a new ERC1155 token with the specified details.
     */
    function createToken(structs.NFTDetails memory _nftData) external {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(supply[_nftData.tokenId] == 0, "TAM"); // Token already minted
        <span class="missing-if-branch" title="else path not taken" >E</span>require(verifyNFTDetails(_nftData) == admin, "IS"); // Invalid Signer
        <span class="missing-if-branch" title="else path not taken" >E</span>if (
            IFactory(factory).viewDividenAddress(_nftData.tokenId) == address(0)
        ) {
            IFactory(factory).createDividend(
                _nftData.tokenId,
                _nftData.owner,
                admin
            );
        }
        _mint(_nftData.owner, _nftData.tokenId, _nftData.fractionsQuantity, "");
        _setURI(_nftData.tokenId, _nftData.uri);
    }
&nbsp;
    /**
     * @dev Buys ERC1155 tokens.
     * @param _nftListing The NFT listing data structure.
     * @param _buyData The buy details data structure.
     * @notice This function allows users to buy ERC1155 tokens from the NFT listing at the given price.
     */
    function buyToken(
        structs.NFTListing memory _nftListing,
        structs.buyDetails memory _buyData
    ) external payable nonReentrant {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(_buyData.timeStamp + 2 minutes &gt;= block.timestamp, "Time Out");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(_buyData.currency != address(0), "EZA"); // ERC20 Token address can't be zero address
        <span class="missing-if-branch" title="else path not taken" >E</span>require(_nftListing.owner != address(0), "NOCZA"); // NFT owner can't be zero address
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
            _buyData.amountToBuy &lt;=
                balanceOf(_nftListing.owner, _nftListing.tokenId),
            "IBA"
        ); // Invalid buy Amount
        <span class="missing-if-branch" title="else path not taken" >E</span>require(_buyData.amountToBuy &gt; 0, "AMZ"); // Amount to buy Zero
        <span class="missing-if-branch" title="else path not taken" >E</span>require(!usedBuyDataCounters[_buyData.counter], "BVU"); // Buy Voucher Used
        setCounter(_nftListing, _buyData.amountToBuy);
        <span class="missing-if-branch" title="else path not taken" >E</span>require(verifyNFTListing(_nftListing) == _nftListing.owner, "IS"); // Invalid Signer
        <span class="missing-if-branch" title="else path not taken" >E</span>require(verifyBuyDetails(_buyData) == conversionRateOperator, "ICOS"); //Invalid conversion rate operator
&nbsp;
        uint256 finalPrice = _buyData.conversionRate * _buyData.amountToBuy;
        uint256 fee = (finalPrice * platformFee) / 10000;
        if (_buyData.currency == address(1)) {
            <span class="missing-if-branch" title="else path not taken" >E</span>require(msg.value &gt;= finalPrice, "IA"); // Insufficient Amount
            (bool success, ) = msg.sender.call{value: finalPrice - fee}("");
            <span class="missing-if-branch" title="else path not taken" >E</span>require(success == true, "ATF"); // Amount Transfer Failed
            (bool feeSuccess, ) = admin.call{value: fee}("");
            <span class="missing-if-branch" title="else path not taken" >E</span>require(feeSuccess == true, "FTF"); // Fee Transfer Failed
        } else {
            <span class="missing-if-branch" title="else path not taken" >E</span>require(
                IERC20Upgradeable(_buyData.currency).balanceOf(msg.sender) &gt;=
                    finalPrice,
                "IA"
            ); // Insufficient Amount
            IERC20Upgradeable(_buyData.currency).transferFrom(
                msg.sender,
                _nftListing.owner,
                finalPrice - fee
            );
            IERC20Upgradeable(_buyData.currency).transferFrom(
                msg.sender,
                admin,
                fee
            );
        }
        <span class="missing-if-branch" title="else path not taken" >E</span>if (factory.viewDividenAddress(_nftListing.tokenId) != address(0)) {
            address dividend = factory.viewDividenAddress(_nftListing.tokenId);
            IDividend(dividend).trackShares(
                _buyData.amountToBuy,
                _nftListing.owner,
                msg.sender
            );
        }
&nbsp;
        usedBuyDataCounters[_buyData.counter] = true;
&nbsp;
        _safeTransferFrom(
            _nftListing.owner,
            msg.sender,
            _nftListing.tokenId,
            _buyData.amountToBuy,
            ""
        );
    }
&nbsp;
    /**
     * @dev Sets the voucher counter for NFT listings.
     * @param _nftListing The NFT listing data structure.
     * @param amountToBuy The amount of NFTs to be bought.
     * @notice This function sets the voucher counter for NFT listings to control the available tokens for sale.
     */
    function setCounter(
        structs.NFTListing memory _nftListing,
        uint256 amountToBuy
    ) internal {
        //Counter used
        <span class="missing-if-branch" title="else path not taken" >E</span>require(!usedListingCounters[_nftListing.counter], "CU");
&nbsp;
        uint256 leftCounter = amountLeft[_nftListing.counter];
&nbsp;
        if (leftCounter == 0) {
            leftCounter = _nftListing.nftAmount - amountToBuy;
        } else {
            leftCounter = leftCounter - amountToBuy;
        }
        <span class="missing-if-branch" title="else path not taken" >E</span>require(leftCounter &gt;= 0, "ALZ"); //Amount left less than zero
&nbsp;
        amountLeft[_nftListing.counter] = leftCounter;
        <span class="missing-if-branch" title="if path not taken" >I</span>if (leftCounter == 0) <span class="cstat-no" title="statement not covered" >usedListingCounters[_nftListing.counter] = true</span>;
    }
&nbsp;
    /**
     * @dev Resets the voucher counter for NFT listings.
     * @param _nftListing The NFT listing data structure.
     * @notice This function resets the voucher counter for NFT listings, allowing more tokens to be bought.
     */
<span class="fstat-no" title="function not covered" >    function resetVoucherCounter(</span>
        structs.NFTListing memory _nftListing
    ) external {
<span class="cstat-no" title="statement not covered" >        require(_nftListing.owner == msg.sender, "IC")</span>; // Invalid caller
<span class="cstat-no" title="statement not covered" >        amountLeft[_nftListing.counter] = 0</span>;
<span class="cstat-no" title="statement not covered" >        usedListingCounters[_nftListing.counter] = true</span>;
    }
&nbsp;
    /**
     * @notice Mints ERC1155 tokens.
     * @param to The address to mint tokens to.
     * @param id The token ID to mint.
     * @param amount The amount of tokens to mint.
     * @param data Additional data to pass to the recipient.
     */
    function _mint(
        address to,
        uint256 id,
        uint256 amount,
        bytes memory data
    ) internal override(ERC1155Upgradeable) {
        supply[id] += amount;
        super._mint(to, id, amount, data);
    }
&nbsp;
    /**
     * @dev Mints a batch of ERC1155 tokens.
     * @param to The address to mint tokens to.
     * @param ids The token IDs to mint.
     * @param amounts The amounts of tokens to mint.
     * @param data Additional data to pass to the recipient.
     * @notice This function allows the contract owner to mint a batch of ERC1155 tokens to a specific address.
     */
    function mintBatch(
        address to,
        uint256[] memory ids,
        uint256[] memory amounts,
        bytes memory data
    ) public onlyAdmin {
        _mintBatch(to, ids, amounts, data);
    }
&nbsp;
    /**
     * @dev Burns ERC1155 tokens.
     * @param from The address to burn tokens from.
     * @param id The token ID to burn.
     * @param amount The amount of tokens to burn.
     * @notice This function allows the contract owner to burn ERC1155 tokens.
     */
    function safeBurn(
        address from,
        uint256 id,
        uint256 amount
    ) public onlyAdmin {
        _burn(from, id, amount);
    }
&nbsp;
    /**
     * @dev Transfers ERC1155 tokens.
     * @param from The address to transfer tokens from.
     * @param to The address to transfer tokens to.
     * @param id The token ID to transfer.
     * @param amount The amount of tokens to transfer.
     * @param data Additional data to pass to the recipient.
     * @notice This function allows the contract owner to transfer ERC1155 tokens.
     */
    function safeTransferFrom(
        address from,
        address to,
        uint256 id,
        uint256 amount,
        bytes memory data
    ) public override(ERC1155Upgradeable) {
        require(msg.sender == admin, "NA"); // Transfer not allowed
        super.safeTransferFrom(from, to, id, amount, data);
    }
&nbsp;
    /**
     * @dev Returns the total supply of a token.
     * @param tokenID The ID of the token.
     * @return The total supply of the token.
     * @notice This function allows anyone to check the total supply of a specific ERC1155 token.
     */
    function tokenSupply(uint tokenID) external view returns (uint256) {
        require(supply[tokenID] &gt; 0, "TDNE"); // Token does not exist
        return supply[tokenID];
    }
&nbsp;
    /**
     * @dev Updates the address of the factory contract.
     * @param _factory The address of the factory contract.
     * @notice This function allows the contract owner to update the address of the factory contract.
     */
<span class="fstat-no" title="function not covered" >    function updateFactory(address _factory) external onlyAdmin {</span>
<span class="cstat-no" title="statement not covered" >        require(_factory != address(0), "ZA")</span>; // Zero address
<span class="cstat-no" title="statement not covered" >        factory = IFactory(_factory)</span>;
    }
&nbsp;
    /**
     * @dev Updates the platformFee of the platform .
     * @param _newFee is The updated value of the platformFee.
     * @notice This function allows the contract admin to update the value of the fplatfromFee.
     */
<span class="fstat-no" title="function not covered" >    function updatePlatformFee(uint256 _newFee) external onlyAdmin {</span>
<span class="cstat-no" title="statement not covered" >        require(_newFee &gt; 0, "ZF")</span>; // Zero Fee
<span class="cstat-no" title="statement not covered" >        platformFee = _newFee</span>;
    }
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Mon Aug 14 2023 11:45:43 GMT+0530 (India Standard Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
